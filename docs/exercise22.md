# Exercise 22: Creating a web certificate

The `acme` provider is used in Terraform to request certificates from different certificate servers implementing the ACME protocol.
To initialize the provider a server as well as a registration with that server is required:

```tf
provider "acme" {
  server_url = "https://acme-staging-v02.api.letsencrypt.org/directory"
  # server_url = "https://acme-v02.api.letsencrypt.org/directory"
}

resource "tls_private_key" "acme_account_private_key" {
  algorithm = "RSA"
}

resource "acme_registration" "registration" {
  email_address   = "dw084@hdm-stuttgart.de"
  account_key_pem = tls_private_key.acme_account_private_key.private_key_pem
}
```

The `acme_certificate` resource can then be used to request a certificate from that server.
To do so the name of the domain that the certificate is registered to (in this case `*.g2.sdi.hdm-stuttgart.cloud`) needs to be provided as well as any alternative names (in this case the zone domain `g2.hdm-stuttgart.cloud`).

The `dns_challenge` argument can be used to provide a DNS challenge in which the *Let's encrypt* server ensures that the necessary DNS entries are present in the DNS server before validating the certificate:

```tf
resource "acme_certificate" "wildcard_certificate" {
  account_key_pem           = acme_registration.registration.account_key_pem
  common_name               = "*.${var.dns_server_domain}"
  subject_alternative_names = [var.dns_server_domain]

  dns_challenge {
    provider = "rfc2136"
    config = {
      RFC2136_NAMESERVER     = "ns1.sdi.hdm-stuttgart.cloud"
      RFC2136_TSIG_ALGORITHM = "hmac-sha512"
      RFC2136_TSIG_KEY       = "g2.key."
      RFC2136_TSIG_SECRET    = var.dns_secret_key
    }
  }
}
```

After the certificate has been created the values from it are used to save them to the `gen` folder in order to use them later (e.g. when applying them to a web server):

```tf
resource "local_file" "tls_private_key" {
  filename        = "./gen/private.pem"
  content         = acme_certificate.wildcard_certificate.private_key_pem
}

resource "local_file" "tls_certificate_key" {
  filename        = "./gen/certificate.pem"
  content         = acme_certificate.wildcard_certificate.certificate_pem
}
```



dwalz@dwolf:/mnt/d/Development/hdm/ss25/sdi/exercise22/configuration$ ./bin/ssh.sh
Linux exercise-20 6.1.0-37-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.140-1 (2025-05-22) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
devops@exercise-20:~$ nano /etc/nginx/sites-available/default
devops@exercise-20:~$ sudo nano /etc/nginx/sites-available/default
devops@exercise-20:~$
devops@exercise-20:~$ sudo nano /etc/nginx/sites-available/default
devops@exercise-20:~$ cat /etc/nginx/sites-available/default
##
# You should look at the following URL's in order to grasp a solid understanding
# of Nginx configuration files in order to fully unleash the power of Nginx.
# https://www.nginx.com/resources/wiki/start/
# https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/
# https://wiki.debian.org/Nginx/DirectoryStructure
#
# In most cases, administrators will remove this file from sites-enabled/ and
# leave it as reference inside of sites-available where it will continue to be
# updated by the nginx packaging team.
#
# This file will automatically load configuration files provided by other
# applications, such as Drupal or Wordpress. These applications will be made
# available underneath a path with that package name, such as /drupal8.
#
# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
##

# Default server configuration
#
server {
        listen 80 default_server;
        listen [::]:80 default_server;

        # SSL configuration
        #
        listen 443 ssl default_server;
        listen [::]:443 ssl default_server;
        #
        # Note: You should disable gzip for SSL traffic.
        # See: https://bugs.debian.org/773332
        #
        # Read up on ssl_ciphers to ensure a secure configuration.
        # See: https://bugs.debian.org/765782
        #
        # Self signed certs generated by the ssl-cert package
        # Don't use them in a production server!
        #
        include snippets/snakeoil.conf;

        root /var/www/html;

        # Add index.php to the list if you are using PHP
        index index.html index.htm index.nginx-debian.html;

        server_name _;

        location / {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                try_files $uri $uri/ =404;
        }

        # pass PHP scripts to FastCGI server
        #
        #location ~ \.php$ {
        #       include snippets/fastcgi-php.conf;
        #
        #       # With php-fpm (or other unix sockets):
        #       fastcgi_pass unix:/run/php/php7.4-fpm.sock;
        #       # With php-cgi (or other tcp sockets):
        #       fastcgi_pass 127.0.0.1:9000;
        #}

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        #location ~ /\.ht {
        #       deny all;
        #}
}


# Virtual Host configuration for example.com
#
# You can move that to a different file under sites-available/ and symlink that
# to sites-enabled/ to enable it.
#
#server {
#       listen 80;
#       listen [::]:80;
#
#       server_name example.com;
#
#       root /var/www/example.com;
#       index index.html;
#
#       location / {
#               try_files $uri $uri/ =404;
#       }
#}
devops@exercise-20:~$ sudo nano /etc/nginx/sites-available/default exit
devops@exercise-20:~$ exit
logout
Connection to workhorse.g2.sdi.hdm-stuttgart.cloud closed.
dwalz@dwolf:/mnt/d/Development/hdm/ss25/sdi/exercise22/configuration$ terraform plan
tls_private_key.server_ssh_key: Refreshing state... [id=001145e64304fd2ef3d3402f497542231dcc96ed]
tls_private_key.acme_account_private_key: Refreshing state... [id=2c9bc6706ac1d22961dbbb31a3b2b3638ea4e294]
hcloud_volume.volume_exercise_20: Refreshing state... [id=103002948]
acme_registration.registration: Refreshing state... [id=https://acme-staging-v02.api.letsencrypt.org/acme/acct/217641194]
hcloud_firewall.fw_exercise_20: Refreshing state... [id=2324824]
module.ssh_wrapper.local_file.known_hosts: Refreshing state... [id=1315fc3b30c617cd2e3ce7b1fddb6e6b88006ede]
local_file.tls_private_key: Refreshing state... [id=5c060afea8ae9ca731ee668e0ddc8d436b546d17]
module.ssh_wrapper.local_file.ssh_bin: Refreshing state... [id=5ccf6ad6761693d2aa3b428cd2c14e518478a09f]
module.ssh_wrapper.local_file.scp_bin: Refreshing state... [id=ecdfc0a87ce70109ab9805b8678e1d8197022680]
dns_cname_record.exercise_dns_alias_records["www"]: Refreshing state... [id=www.g2.sdi.hdm-stuttgart.cloud.]
dns_cname_record.exercise_dns_alias_records["mail"]: Refreshing state... [id=mail.g2.sdi.hdm-stuttgart.cloud.]
acme_certificate.wildcard_certificate: Refreshing state... [id=7dc08b28-8dc7-8590-9bb3-2ccabdb791ba]
local_file.tls_certificate_key: Refreshing state... [id=98628dcfa94d2a652b2b399b00fef103baf8bded]
local_file.cloud_init: Refreshing state... [id=923a23b97f6dc5e555699ae9515c52886329bb01]
hcloud_server.exercise_20: Refreshing state... [id=105771291]
hcloud_volume_attachment.exercise_volume_attachment: Refreshing state... [id=103002948]
hcloud_firewall_attachment.exercise_fw_attachment: Refreshing state... [id=2324824]
dns_a_record_set.exercise_dns_name_record: Refreshing state... [id=workhorse.g2.sdi.hdm-stuttgart.cloud.]
dns_a_record_set.exercise_dns_base_record: Refreshing state... [id=g2.sdi.hdm-stuttgart.cloud.]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  ~ update in-place
-/+ destroy and then create replacement

Terraform will perform the following actions:

  # dns_a_record_set.exercise_dns_base_record will be updated in-place
  ~ resource "dns_a_record_set" "exercise_dns_base_record" {
      ~ addresses = [
          - "95.216.223.223",
        ] -> (known after apply)
        id        = "g2.sdi.hdm-stuttgart.cloud."
        # (2 unchanged attributes hidden)
    }

  # dns_a_record_set.exercise_dns_name_record will be updated in-place
  ~ resource "dns_a_record_set" "exercise_dns_name_record" {
      ~ addresses = [
          - "95.216.223.223",
        ] -> (known after apply)
        id        = "workhorse.g2.sdi.hdm-stuttgart.cloud."
        name      = "workhorse"
        # (2 unchanged attributes hidden)
    }

  # hcloud_firewall_attachment.exercise_fw_attachment will be replaced due to changes in replace_triggered_by
-/+ resource "hcloud_firewall_attachment" "exercise_fw_attachment" {
      ~ id              = "2324824" -> (known after apply)
      - label_selectors = [] -> null
      ~ server_ids      = [
          - 105771291,
        ] -> (known after apply)
        # (1 unchanged attribute hidden)
    }

  # hcloud_server.exercise_20 must be replaced
-/+ resource "hcloud_server" "exercise_20" {
      + backup_window              = (known after apply)
      ~ datacenter                 = "hel1-dc2" -> (known after apply)
      ~ firewall_ids               = [
          - 2324824,
        ] -> (known after apply)
      ~ id                         = "105771291" -> (known after apply)
      ~ ipv4_address               = "95.216.223.223" -> (known after apply)
      ~ ipv6_address               = "2a01:4f9:c013:e1a8::1" -> (known after apply)
      ~ ipv6_network               = "2a01:4f9:c013:e1a8::/64" -> (known after apply)
      - labels                     = {} -> null
        name                       = "exercise-20"
      - placement_group_id         = 0 -> null
      ~ primary_disk_size          = 40 -> (known after apply)
      ~ status                     = "running" -> (known after apply)
      ~ user_data                  = (sensitive value) # forces replacement
        # (10 unchanged attributes hidden)
    }

  # hcloud_volume_attachment.exercise_volume_attachment will be replaced due to changes in replace_triggered_by
-/+ resource "hcloud_volume_attachment" "exercise_volume_attachment" {
      ~ id        = "103002948" -> (known after apply)
      ~ server_id = 105771291 -> (known after apply) # forces replacement
        # (2 unchanged attributes hidden)
    }

  # local_file.cloud_init must be replaced
-/+ resource "local_file" "cloud_init" {
      ~ content              = (sensitive value) # forces replacement
      ~ content_base64sha256 = "yH7vuZ6QXui5Arp74m5Cd+UH6olTwf1FTw7+1iU0iC8=" -> (known after apply)
      ~ content_base64sha512 = "7GRH9TjHKRwYEPH5eEjC8saDFnVGGGIo7HVqjxECaFSEZUX3sWGLpSBIvxPbYd2aTXIrRSMferzdz/syClxYSQ==" -> (known after apply)
      ~ content_md5          = "0ff4cc438028c46636c28540146f5df5" -> (known after apply)
      ~ content_sha1         = "923a23b97f6dc5e555699ae9515c52886329bb01" -> (known after apply)
      ~ content_sha256       = "c87eefb99e905ee8b902ba7be26e4277e507ea8953c1fd454f0efed62534882f" -> (known after apply)
      ~ content_sha512       = "ec6447f538c7291c1810f1f97848c2f2c683167546186228ec756a8f11026854846545f7b1618ba52048bf13db61dd9a4d722b45231f7abcddcffb320a5c5849" -> (known after apply)
      ~ id                   = "923a23b97f6dc5e555699ae9515c52886329bb01" -> (known after apply)
        # (3 unchanged attributes hidden)
    }

Plan: 4 to add, 2 to change, 4 to destroy.

Changes to Outputs:
  ~ server_datacenter = "hel1-dc2" -> (known after apply)
  ~ server_ip         = "95.216.223.223" -> (known after apply)

─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Note: You didn't use the -out option to save this plan, so Terraform can't guarantee to take exactly these actions if you run "terraform apply" now.
dwalz@dwolf:/mnt/d/Development/hdm/ss25/sdi/exercise22/configuration$ terraform apply
dns_cname_record.exercise_dns_alias_records["www"]: Refreshing state... [id=www.g2.sdi.hdm-stuttgart.cloud.]
dns_cname_record.exercise_dns_alias_records["mail"]: Refreshing state... [id=mail.g2.sdi.hdm-stuttgart.cloud.]
hcloud_volume.volume_exercise_20: Refreshing state... [id=103002948]
hcloud_firewall.fw_exercise_20: Refreshing state... [id=2324824]
tls_private_key.acme_account_private_key: Refreshing state... [id=2c9bc6706ac1d22961dbbb31a3b2b3638ea4e294]
tls_private_key.server_ssh_key: Refreshing state... [id=001145e64304fd2ef3d3402f497542231dcc96ed]
acme_registration.registration: Refreshing state... [id=https://acme-staging-v02.api.letsencrypt.org/acme/acct/217641194]
local_file.tls_private_key: Refreshing state... [id=5c060afea8ae9ca731ee668e0ddc8d436b546d17]
module.ssh_wrapper.local_file.known_hosts: Refreshing state... [id=1315fc3b30c617cd2e3ce7b1fddb6e6b88006ede]
module.ssh_wrapper.local_file.scp_bin: Refreshing state... [id=ecdfc0a87ce70109ab9805b8678e1d8197022680]
module.ssh_wrapper.local_file.ssh_bin: Refreshing state... [id=5ccf6ad6761693d2aa3b428cd2c14e518478a09f]
acme_certificate.wildcard_certificate: Refreshing state... [id=7dc08b28-8dc7-8590-9bb3-2ccabdb791ba]
local_file.tls_certificate_key: Refreshing state... [id=98628dcfa94d2a652b2b399b00fef103baf8bded]
local_file.cloud_init: Refreshing state... [id=923a23b97f6dc5e555699ae9515c52886329bb01]
hcloud_server.exercise_20: Refreshing state... [id=105771291]
dns_a_record_set.exercise_dns_name_record: Refreshing state... [id=workhorse.g2.sdi.hdm-stuttgart.cloud.]
dns_a_record_set.exercise_dns_base_record: Refreshing state... [id=g2.sdi.hdm-stuttgart.cloud.]
hcloud_volume_attachment.exercise_volume_attachment: Refreshing state... [id=103002948]
hcloud_firewall_attachment.exercise_fw_attachment: Refreshing state... [id=2324824]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  ~ update in-place
-/+ destroy and then create replacement

Terraform will perform the following actions:

  # dns_a_record_set.exercise_dns_base_record will be updated in-place
  ~ resource "dns_a_record_set" "exercise_dns_base_record" {
      ~ addresses = [
          - "95.216.223.223",
        ] -> (known after apply)
        id        = "g2.sdi.hdm-stuttgart.cloud."
        # (2 unchanged attributes hidden)
    }

  # dns_a_record_set.exercise_dns_name_record will be updated in-place
  ~ resource "dns_a_record_set" "exercise_dns_name_record" {
      ~ addresses = [
          - "95.216.223.223",
        ] -> (known after apply)
        id        = "workhorse.g2.sdi.hdm-stuttgart.cloud."
        name      = "workhorse"
        # (2 unchanged attributes hidden)
    }

  # hcloud_firewall_attachment.exercise_fw_attachment will be replaced due to changes in replace_triggered_by
-/+ resource "hcloud_firewall_attachment" "exercise_fw_attachment" {
      ~ id              = "2324824" -> (known after apply)
      - label_selectors = [] -> null
      ~ server_ids      = [
          - 105771291,
        ] -> (known after apply)
        # (1 unchanged attribute hidden)
    }

  # hcloud_server.exercise_20 must be replaced
-/+ resource "hcloud_server" "exercise_20" {
      + backup_window              = (known after apply)
      ~ datacenter                 = "hel1-dc2" -> (known after apply)
      ~ firewall_ids               = [
          - 2324824,
        ] -> (known after apply)
      ~ id                         = "105771291" -> (known after apply)
      ~ ipv4_address               = "95.216.223.223" -> (known after apply)
      ~ ipv6_address               = "2a01:4f9:c013:e1a8::1" -> (known after apply)
      ~ ipv6_network               = "2a01:4f9:c013:e1a8::/64" -> (known after apply)
      - labels                     = {} -> null
        name                       = "exercise-20"
      - placement_group_id         = 0 -> null
      ~ primary_disk_size          = 40 -> (known after apply)
      ~ status                     = "running" -> (known after apply)
      ~ user_data                  = (sensitive value) # forces replacement
        # (10 unchanged attributes hidden)
    }

  # hcloud_volume_attachment.exercise_volume_attachment will be replaced due to changes in replace_triggered_by
-/+ resource "hcloud_volume_attachment" "exercise_volume_attachment" {
      ~ id        = "103002948" -> (known after apply)
      ~ server_id = 105771291 -> (known after apply) # forces replacement
        # (2 unchanged attributes hidden)
    }

  # local_file.cloud_init must be replaced
-/+ resource "local_file" "cloud_init" {
      ~ content              = (sensitive value) # forces replacement
      ~ content_base64sha256 = "yH7vuZ6QXui5Arp74m5Cd+UH6olTwf1FTw7+1iU0iC8=" -> (known after apply)
      ~ content_base64sha512 = "7GRH9TjHKRwYEPH5eEjC8saDFnVGGGIo7HVqjxECaFSEZUX3sWGLpSBIvxPbYd2aTXIrRSMferzdz/syClxYSQ==" -> (known after apply)
      ~ content_md5          = "0ff4cc438028c46636c28540146f5df5" -> (known after apply)
      ~ content_sha1         = "923a23b97f6dc5e555699ae9515c52886329bb01" -> (known after apply)
      ~ content_sha256       = "c87eefb99e905ee8b902ba7be26e4277e507ea8953c1fd454f0efed62534882f" -> (known after apply)
      ~ content_sha512       = "ec6447f538c7291c1810f1f97848c2f2c683167546186228ec756a8f11026854846545f7b1618ba52048bf13db61dd9a4d722b45231f7abcddcffb320a5c5849" -> (known after apply)
      ~ id                   = "923a23b97f6dc5e555699ae9515c52886329bb01" -> (known after apply)
        # (3 unchanged attributes hidden)
    }

Plan: 4 to add, 2 to change, 4 to destroy.

Changes to Outputs:
  ~ server_datacenter = "hel1-dc2" -> (known after apply)
  ~ server_ip         = "95.216.223.223" -> (known after apply)

Do you want to perform these actions?
  Terraform will perform the actions described above.
  Only 'yes' will be accepted to approve.

  Enter a value: yes

hcloud_volume_attachment.exercise_volume_attachment: Destroying... [id=103002948]
hcloud_firewall_attachment.exercise_fw_attachment: Destroying... [id=2324824]
hcloud_firewall_attachment.exercise_fw_attachment: Destruction complete after 2s
hcloud_volume_attachment.exercise_volume_attachment: Destruction complete after 4s
hcloud_server.exercise_20: Destroying... [id=105771291]
hcloud_server.exercise_20: Destruction complete after 8s
local_file.cloud_init: Destroying... [id=923a23b97f6dc5e555699ae9515c52886329bb01]
local_file.cloud_init: Destruction complete after 0s
local_file.cloud_init: Creating...
local_file.cloud_init: Creation complete after 0s [id=6bd71fdc395ac3d3dd94c75297cae1e359bb58ad]
hcloud_server.exercise_20: Creating...
hcloud_server.exercise_20: Still creating... [00m10s elapsed]
hcloud_server.exercise_20: Creation complete after 12s [id=105772030]
hcloud_volume_attachment.exercise_volume_attachment: Creating...
hcloud_firewall_attachment.exercise_fw_attachment: Creating...
hcloud_firewall_attachment.exercise_fw_attachment: Creation complete after 2s [id=2324824]
hcloud_volume_attachment.exercise_volume_attachment: Creation complete after 8s [id=103002948]

Apply complete! Resources: 4 added, 0 changed, 4 destroyed.

Outputs:

server_datacenter = "hel1-dc2"
server_ip = "95.216.223.223"
volume_device = "/dev/disk/by-id/scsi-0HC_Volume_103002948"
dwalz@dwolf:/mnt/d/Development/hdm/ss25/sdi/exercise22/configuration$

$ ./bin/ssh.sh
Linux exercise-20 6.1.0-37-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.140-1 (2025-05-22) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
devops@exercise-20:~$ openssl rsa -in /etc/nginx/ssl/private.pem -noout -modulus | openssl md5
MD5(stdin)= 9b486c6d6d539a37e3b152cfbfcd1b9b
devops@exercise-20:~$ openssl x509 -in /etc/nginx/ssl/.pem -noout -modulus | openssl md5
certificate.pem  private.pem
devops@exercise-20:~$ openssl x509 -in /etc/nginx/ssl/.pem -noout -modulus | openssl md5
certificate.pem  private.pem
devops@exercise-20:~$ openssl x509 -in /etc/nginx/ssl/certificate.pem -noout -modulus | openssl md5
MD5(stdin)= 9b486c6d6d539a37e3b152cfbfcd1b9b
devops@exercise-20:~$ sudo nano /etc/nginx/sites-available/default
devops@exercise-20:~$ sudo nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
devops@exercise-20:~$ systemctl restart nginx
Failed to execute /usr/bin/pkttyagent: No such file or directory
Failed to restart nginx.service: Access denied
See system logs and 'systemctl status nginx.service' for details.
devops@exercise-20:~$ sudo systemctl restart nginx
devops@exercise-20:~$ sudo systemctl status nginx
● nginx.service - A high performance web server and a reverse proxy server
     Loaded: loaded (/lib/systemd/system/nginx.service; enabled; preset: enabled)
     Active: active (running) since Fri 2025-08-01 14:20:14 UTC; 6s ago
       Docs: man:nginx(8)
    Process: 2517 ExecStartPre=/usr/sbin/nginx -t -q -g daemon on; master_process on; (code=exited, status=0/SUCCESS)
    Process: 2518 ExecStart=/usr/sbin/nginx -g daemon on; master_process on; (code=exited, status=0/SUCCESS)
   Main PID: 2519 (nginx)
      Tasks: 3 (limit: 2250)
     Memory: 2.7M
        CPU: 15ms
     CGroup: /system.slice/nginx.service
             ├─2519 "nginx: master process /usr/sbin/nginx -g daemon on; master_process on;"
             ├─2520 "nginx: worker process"
             └─2521 "nginx: worker process"

Aug 01 14:20:14 exercise-20 systemd[1]: Starting nginx.service - A high performance web server and a reverse proxy server...
Aug 01 14:20:14 exercise-20 systemd[1]: Started nginx.service - A high performance web server and a reverse proxy server.
devops@exercise-20:~$ exit
logout
Connection to workhorse.g2.sdi.hdm-stuttgart.cloud closed.


dwalz@dwolf:/mnt/d/Development/hdm/ss25/sdi/exercise22/configuration$ ./bin/ssh.sh
Linux exercise-20 6.1.0-37-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.140-1 (2025-05-22) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Fri Aug  1 14:16:22 2025 from 91.16.131.250
devops@exercise-20:~$ cat /
bin/            dev/            home/           initrd.img.old  lib64/          media/          opt/            root/           sbin/           sys/            usr/            vmlinuz         volume01/
boot/           etc/            initrd.img      lib/            lost+found/     mnt/            proc/           run/            srv/            tmp/            var/            vmlinuz.old
devops@exercise-20:~$ cat /
bin/            dev/            home/           initrd.img.old  lib64/          media/          opt/            root/           sbin/           sys/            usr/            vmlinuz         volume01/
boot/           etc/            initrd.img      lib/            lost+found/     mnt/            proc/           run/            srv/            tmp/            var/            vmlinuz.old
devops@exercise-20:~$ cat /etc/nginx/sites-available/default
##
# You should look at the following URL's in order to grasp a solid understanding
# of Nginx configuration files in order to fully unleash the power of Nginx.
# https://www.nginx.com/resources/wiki/start/
# https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/
# https://wiki.debian.org/Nginx/DirectoryStructure
#
# In most cases, administrators will remove this file from sites-enabled/ and
# leave it as reference inside of sites-available where it will continue to be
# updated by the nginx packaging team.
#
# This file will automatically load configuration files provided by other
# applications, such as Drupal or Wordpress. These applications will be made
# available underneath a path with that package name, such as /drupal8.
#
# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
##

# Default server configuration
#
server {
        listen 80 default_server;
        listen [::]:80 default_server;

        # SSL configuration
        #
        listen 443 ssl default_server;
        listen [::]:443 ssl default_server;

        ssl_certificate /etc/nginx/ssl/certificate.pem;
        ssl_certificate_key /etc/nginx/ssl/private.pem;
        #
        # Note: You should disable gzip for SSL traffic.
        # See: https://bugs.debian.org/773332
        #
        # Read up on ssl_ciphers to ensure a secure configuration.
        # See: https://bugs.debian.org/765782
        #
        # Self signed certs generated by the ssl-cert package
        # Don't use them in a production server!
        #
        # include snippets/snakeoil.conf;

        root /var/www/html;

        # Add index.php to the list if you are using PHP
        index index.html index.htm index.nginx-debian.html;

        server_name _;

        location / {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                try_files $uri $uri/ =404;
        }

        # pass PHP scripts to FastCGI server
        #
        #location ~ \.php$ {
        #       include snippets/fastcgi-php.conf;
        #
        #       # With php-fpm (or other unix sockets):
        #       fastcgi_pass unix:/run/php/php7.4-fpm.sock;
        #       # With php-cgi (or other tcp sockets):
        #       fastcgi_pass 127.0.0.1:9000;
        #}

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        #location ~ /\.ht {
        #       deny all;
        #}
}


# Virtual Host configuration for example.com
#
# You can move that to a different file under sites-available/ and symlink that
# to sites-enabled/ to enable it.
#
#server {
#       listen 80;
#       listen [::]:80;
#
#       server_name example.com;
#
#       root /var/www/example.com;
#       index index.html;
#
#       location / {
#               try_files $uri $uri/ =404;
#       }
#}
devops@exercise-20:~$